<!DOCTYPE HTML>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <title>Табло рейсов аэропорта</title>
  <link rel="stylesheet" href="css/style.css" />
  <link  rel="stylesheet" href="css/fontawesome.css" />
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
</head>
<body>
	<div class="wrapper">
		<div class="container">
			<a href="/"><h1 class="h1">Табло аэропорта</h1></a>
		<div class="menu">
		<div class="search">
			<input type="text" name="search" placeholder="Поиск по номеру рейса"> 
			<button type="submit" id="search"></button>
			</div>
			<a href="#" id="departure">Вылетающие рейсы</a>
			<a href="#" id="arrival">Прилетающие рейсы</a>
		</div>
		<div class="header-result">
			<div class="time">Время прибытия/отправления</div>
			<div class="city">Направление</div>
			<div class="number">Номер рейса</div>
			<div class="airline-name">Авиакомпания</div>
		</div>
		<div id="result">
		</div>
		</div>
		<script type="text/javascript">
		
		var PrintReis = function(json, even){
			var str, time;
			for (var i =0; i < json.schedule.length - 1; i++){
				if (even === 'dep') time = json.schedule[i].departure;
				else time = json.schedule[i].arrival;
				var html_str = '<div class="item">'+
					'<div class="time">'+
							'<time>'+ time +'</time>'+
					'</div>'+
					'<div class="city">'+
							'<span class="flight-row__city-name">'+ json.schedule[i].thread.title +'</span>'+
					'</div>'+					
					'<div class="number">'+
								'<span>'+json.schedule[i].thread.number+'</span>'+
					'</div>'+
					'<div class="airline-name">'+
								'<span class="airline">' + json.schedule[i].thread.carrier.title + '</span><br>'+
								'<span class="name">"' + json.schedule[i].thread.vehicle + '"</span>'+
					'</div>'+
				'</div>';
			 str +=html_str;
			}
			return str;
		}
		var departure_json, arrival_json;
		$.ajax({
			url:'plane.json',
			success: function(data) {
				var html_str = PrintReis(data, 'dep');
				$('#result').append(html_str);
				departure_json = data;
			}
		});
		$.ajax({
			url:'arrival.json',
			success: function(data) {
				var html_str = PrintReis(data, 'arr');
				$('#result').append(html_str);
				arrival_json = data;
			}
		});
		
		
		$('#departure').click(function(){
			var url1 = 'https://api.rasp.yandex.net/v3.0/schedule/?apikey=d9f48ede-1554-4293-8cba-392958f24c50&station=s9600213&format=json&date=2018-11-28&transport_types=plane&direction=%D0%BD%D0%B0%20%D0%9C%D0%BE%D1%81%D0%BA%D0%B2%D1%83&event=departure';
			var url = 'plane.json';
			$.ajax({
				url:url,
				success: function(data) {
					var html_str = PrintReis(data, 'dep');
					$('#result').html(html_str);
				}
			});
		});
		$('#arrival').click(function(){
			var url1 = 'https://api.rasp.yandex.net/v3.0/schedule/?apikey=d9f48ede-1554-4293-8cba-392958f24c50&station=s9600213&format=json&date=2018-11-28&transport_types=plane&direction=%D0%BD%D0%B0%20%D0%9C%D0%BE%D1%81%D0%BA%D0%B2%D1%83&event=arrival';
			var url = 'arrival.json';
			$.ajax({
				url:url,
				success: function(data) {
					var html_str = PrintReis(data, 'arr');
					$('#result').html(html_str);
				}
			});
		});
		$('#search').click(function(){
			var result = arrival_json.schedule.filter(obj => obj.thread.number == 'QS 1198')[0]; 
			console.log(result); 
			});
		);
		</script>
	</div>
</body>
</html>